(function(U){var O="embeddedServiceHelpButton";var aB=".embeddedServiceSidebar";var aq=[".salesforce.com",".force.com",".sfdc.net"];var ag="esw_storage_iframe";var P="snapins_invite";var ac="esw-snapin-target";var l="slds-scope";var E="5.0";var az=100;var L="__snapinsLoginCallback";var t="__snapinsLogoutCallback";var R="ESW_OAUTH_TOKEN";var ap="ESW_BODY_SCROLL_POSITION";var e="ESW_IS_MINIMIZED";var ay="ESW_MINIMIZED_TEXT";var i='dir="rtl"';function B(){var aD=false;var aE;this.settings={appendHelpButton:true,displayHelpButton:true,isExternalPage:true,devMode:false,targetElement:document.body,elementForOnlineDisplay:undefined,elementForOfflineDisplay:undefined,defaultMinimizedText:"",disabledMinimizedText:"",defaultAssistiveText:"",loadingText:"Loading",showIcon:undefined,enabledFeatures:[],entryFeature:"FieldService",storageDomain:document.domain,language:undefined,linkAction:{feature:undefined,name:undefined,valid:false},linkActionParameters:{},useCustomAuthentication:false,allowGuestUsers:false,requireSLDS:false};this.auth={};this.validLinkActions={};this.isMasterAndHasSlaves=false;Object.defineProperty(this.auth,"oauthToken",{get:function(){return aE;},set:function(aF){if(this.validateHeaderValue(aF)){aE=aF;if(aF){this.setSessionData(R,aF);this.checkAuthentication();}else{this.deleteSessionData(R);}}else{this.error('"'+aF+'" is not a valid OAuth token.');}}.bind(this)});this.featureScripts={};this.eventHandlers={};this.messageHandlers={};this.storageKeys=[ap,e,ay,R];this.defaultSettings={};this.snippetSettingsFile={};this.eswFrame=undefined;this.availableFeatures=["script","session"];this.outboundMessagesAwaitingIframeLoad=[];this.pendingMessages={};this.iframeScriptsToLoad=[];this.domInitInProgress=false;this.componentInitInProgress=false;this.hasSessionDataLoaded=false;this.isIframeReady=false;this.isAuthenticationRequired=false;this.loginPendingSerializedData=undefined;Object.defineProperty(this,"isButtonDisabled",{get:function(){return aD;},set:function(aF){aD=aF;this.onButtonStatusChange();}.bind(this),configurable:true});this.setupMessageListener();this.getLinkActionData();}B.prototype.adjustCommunityStorageDomain=function(){if(this.isCommunityDomain(this.settings.storageDomain)){this.settings.storageDomain=this.settings.storageDomain+"/"+window.location.pathname.split("/")[1];}};B.prototype.loadLightningOutScripts=function(aD){if(typeof Promise!=="function"){this.loadScriptFromDirectory("common","promisepolyfill",function(){this.loadLightningOutScripts(aD);}.bind(this),true);}else{return new Promise(function(aI,aH){var aE;var aG;try{aE=aD&&aD.baseCoreURL?aD.baseCoreURL:embedded_svc.settings.baseCoreURL;if(window.$Lightning){aI("Lightning Out is already loaded on this page.");}else{if(typeof $A!=="undefined"&&$A.get("$Site")){aI("Communities context does not require Lightning Out to use Embedded Service.");}else{if(aE){aG=document.createElement("script");aG.type="text/javascript";aG.src=aE+"/lightning/lightning.out.js";aG.onload=aI.bind(this,"Lightning Out scripts loaded.");document.getElementsByTagName("head")[0].appendChild(aG);}}}}catch(aF){aH(aF);}});}};B.prototype.instantiateLightningOutApplication=function(aD){if(typeof Promise!=="function"){this.loadScriptFromDirectory("common","promisepolyfill",function(){this.instantiateLightningOutApplication(aD);}.bind(this),true);}else{return new Promise(function(aI,aH){var aG;var aF;var aJ;try{aG=aD&&aD.communityEndpointURL?aD.communityEndpointURL:embedded_svc.settings.communityEndpointURL;aF=aD&&aD.oauthToken?aD.oauthToken:embedded_svc.settings.oauthToken;aJ=aD&&aD.paramsObj?aD.paramsObj:embedded_svc.settings.language||undefined;if(typeof $A!=="undefined"&&$A.get("$Site")){aI("Communities context already has an Aura context.");}else{if(window.$Lightning){$Lightning.use("embeddedService:sidebarApp",aI.bind(this,"Lightning Out application request complete."),aG,aF,aJ);}}}catch(aE){aH(aE);}});}};B.prototype.createEmbeddedServiceComponent=function(aD){if(typeof Promise!=="function"){this.loadScriptFromDirectory("common","promisepolyfill",function(){this.createEmbeddedServiceComponent(aD);}.bind(this),true);}else{return new Promise(function(aI,aH){var aG;var aF;try{aG=aD&&aD.attributes?aD.attributes:{configurationData:embedded_svc.settings};aF=aD&&aD.locator?aD.locator:embedded_svc.settings.targetElement;embedded_svc.preparePageForSidebar();if(window.$Lightning&&!document.querySelector(aB)){$Lightning.ready($Lightning.createComponent.bind(this,"embeddedService:sidebar",aG,aF,function(aL,aJ,aK){if(aJ==="SUCCESS"){embedded_svc.addEventHandler("afterInitialization",aI.bind(this,"Embedded Service component created."));}else{aH(aK);}}));}else{if(typeof $A!=="undefined"&&$A.get("$Site")){window.dispatchEvent(new CustomEvent("embeddedServiceCreateSidebar",{detail:{componentAttributes:aG,resolve:aI,reject:aH}}));}else{typeof window.$Lightning==="undefined"?aI("Lighning Out should be loaded on this page before creating the Embedded Service component."):aI("Embedded Service component already exists.");}}}catch(aE){aH(aE);}});}};B.prototype.bootstrapEmbeddedService=function(aD){if(typeof Promise!=="function"){this.loadScriptFromDirectory("common","promisepolyfill",function(){this.bootstrapEmbeddedService(aD);},true);}else{return new Promise(function(aG,aF){try{embedded_svc.loadLightningOutScripts(aD).then(function(){embedded_svc.instantiateLightningOutApplication(aD).then(function(){embedded_svc.createEmbeddedServiceComponent(aD).then(function(){window.requestAnimationFrame(aG.bind(this,"Embedded Service application and component bootstrapped."));});});});}catch(aE){aF(aE);}});}};B.prototype.isInternetExplorer=function(){return"ActiveXObject" in window;};B.prototype.outputToConsole=function N(aE,aD){if(this.settings.devMode&&console&&console[aE]){console[aE]("[Snap-ins] "+(Array.isArray(aD)?aD.join(", "):aD));}};B.prototype.log=function f(){this.outputToConsole("log",[].slice.apply(arguments));};B.prototype.error=function af(aD){if(aD){this.outputToConsole("error",aD);}else{this.outputToConsole("error","esw responed with an unspecified error.");}this.fireEvent("error");};B.prototype.warning=function Q(aD){if(aD){this.outputToConsole("warn","Warning: "+aD);}else{this.outputToConsole("warn","esw sent an anonymous warning.");}};B.prototype.deprecated=function r(aD){this.warning(aD+" is deprecated in version "+Number(E).toFixed(1)+" and will be removed in version "+(Number(E)+1).toFixed(1));};B.prototype.getCookie=function p(aF){var aG=document.cookie;var aE;var aD;if(aG){aE=aG.indexOf(aF+"=");if(aE!==-1){aE+=(aF+"=").length;aD=aG.indexOf(";",aE);if(aD===-1){aD=aG.length;}return aG.substring(aE,aD);}}return undefined;};B.prototype.setCookie=function al(aF,aH,aD){var aG=aF+"="+aH+";";var aE;if(aD){aE=new Date();aE.setFullYear(aE.getFullYear()+10);aG+="expires="+aE.toUTCString()+";";}aG+="path=/;";document.cookie=aG;};B.prototype.mergeSettings=function ax(aD){Object.keys(aD).forEach(function(aE){if(this.settings[aE]===undefined){this.settings[aE]=aD[aE];}}.bind(this));};B.prototype.loadFeatureScript=function M(aD,aF){var aE=decodeURI(aD).toLowerCase();if(aD.indexOf("..")===-1){this.loadScriptFromDirectory("client",aE+".esw",function(){this.featureScripts[aD](this);this.availableFeatures.push(aE);this.fireEvent("featureLoaded",undefined,aD);if(aF){aF();}this.processPendingMessages(aE);}.bind(this));}else{this.error('"'+aD+'" is not a valid feature name.');}};B.prototype.fireEvent=function Y(aG,aD){var aE=this.eventHandlers[aG.toLowerCase()];var aF=[].slice.apply(arguments).slice(2);var aH=[];if(aE){aE.forEach(function(aI){aH.push(aI.apply(undefined,aF));});}if(aD){return aD(aH);}return true;};B.prototype.isValidEntityId=function ar(aD){return typeof aD==="string"&&(aD.length===18||aD.length===15);};B.prototype.getKeyPrefix=function A(aD){if(this.isValidEntityId(aD)){return aD.substr(0,3);}return undefined;};B.prototype.isOrganizationId=function am(aD){return this.getKeyPrefix(aD)==="00D";};B.prototype.getESWFrame=function aA(){var aD=document.getElementById(ag);if(!this.eswFrame&&aD){this.eswFrame=aD.contentWindow;}return this.eswFrame;};B.prototype.isFrameStorageEnabled=function c(){this.deprecated("isFrameStorageEnabled");return true;};B.prototype.processPendingMessages=function a(aD){if(this.pendingMessages[aD]){this.pendingMessages[aD].forEach(function(aE){this.handleMessage(aE.payload);}.bind(this));this.pendingMessages[aD]=undefined;}};B.prototype.loadCSS=function F(){var aD=document.createElement("link");var aE=this.settings.gslbBaseURL?this.settings.gslbBaseURL:this.settings.baseCoreURL;aD.href=aE+"/embeddedservice/"+this.settings.releaseVersion+"/esw"+(this.settings.devMode?"":".min")+".css";aD.type="text/css";aD.rel="stylesheet";document.getElementsByTagName("head")[0].appendChild(aD);};B.prototype.appendHelpButton=function X(aE){var aF=document.createElement("div");var aD="";aF.className=O;if(this.isLanguageRtl(this.settings.language)&&this.isDesktop()){aD=i;}aF.innerHTML='<div class="helpButton"'+aD+">"+'<button class="helpButtonEnabled uiButton" href="javascript:void(0)">'+'<span class="embeddedServiceIcon" aria-hidden="true" data-icon="&#59648;"></span>'+'<span class="helpButtonLabel" id="helpButtonSpan" aria-live="polite" aria-atomic="true">'+'<span class="assistiveText">'+(this.settings.defaultAssistiveText||"")+"</span>"+'<span class="message"></span>'+"</span>"+"</button>"+"</div>";if(!aE){aF.style.display="none";}this.settings.targetElement.appendChild(aF);this.setHelpButtonText(this.settings.defaultMinimizedText);if("ontouchstart" in document.documentElement){[].slice.apply(document.querySelectorAll(".embeddedServiceHelpButton .uiButton")).forEach(function(aG){aG.classList.add("no-hover");});}this.onButtonStatusChange();};B.prototype.appendIFrame=function J(){var aE=document.createElement("iframe");var aD={};aE.id=ag;aE.src=this.settings.iframeURL;aE.style.display="none";aE.onload=function(){var aF=this.getESWFrame();this.isIframeReady=true;this.outboundMessagesAwaitingIframeLoad.forEach(function(aG){aF.postMessage(aG,this.settings.iframeURL);}.bind(this));this.outboundMessagesAwaitingIframeLoad=[];this.iframeScriptsToLoad.forEach(function(aG){this.loadStorageScript(aG);}.bind(this));aD.deploymentId=this.settings.deploymentId;aD.isSamePageNavigation=this.isSamePageNavigation();aD.isRefresh=window.performance.navigation.type===1;this.postMessage("session.updateStorage",aD);this.iframeScriptsToLoad=[];}.bind(this);this.settings.targetElement.appendChild(aE);window.addEventListener("beforeunload",function(aF){var aG="You might lose the active chat session if you close this tab. Are you sure?";if(this.isInternetExplorer()){aE.src="about:blank";}if(this.isMasterAndHasSlaves){this.fireEvent("snapinsCloseSessionWarning");if(this.settings.closeSessionWarning&&typeof this.settings.closeSessionWarning==="function"){this.settings.closeSessionWarning();}else{(aF||window.event).returnValue=aG;return aG;}}this.postMessage("chasitor.decrementActiveChatSession",this.settings.deploymentId);}.bind(this),false);};B.prototype.preparePageForSidebar=function j(){var aD={};if(document.getElementById(P)&&embedded_svc.inviteAPI){embedded_svc.inviteAPI.inviteButton.setOnlineState(false);}this.hideHelpButton();this.fireEvent("beforeCreate");Object.keys(this.settings).forEach(function(aE){aD[aE]=this.settings[aE];}.bind(this));this.mergeSettings(this.defaultSettings);};B.prototype.createLightningComponent=function w(aD){this.preparePageForSidebar();this.createEmbeddedServiceComponent({attributes:{configurationData:this.settings,serializedSessionData:aD},locator:this.settings.targetElement}).then(function(){this.componentInitInProgress=false;this.setHelpButtonText(this.settings.defaultMinimizedText);this.fireEvent("ready");}.bind(this));};B.prototype.loadLightningApp=function ao(aE){var aG=this.settings.language&&this.settings.language.trim()!==""?{guestUserLang:this.settings.language}:undefined;var aD;var aF;if(this.settings.isExternalPage&&typeof this.settings.communityEndpointURL!=="string"){throw new Error("communityEndpointURL String property not set");}aD=document.getElementsByClassName("helpButton")[0];if(aD){aF=aD.getBoundingClientRect().width;if(aF>0){aD.style.width=aF+"px";}}this.setHelpButtonText(this.settings.loadingText,false);this.instantiateLightningOutApplication({communityEndpointURL:this.settings.communityEndpointURL,oauthToken:this.auth.oauthToken,paramsObj:aG}).then(this.createLightningComponent.bind(this,aE));};B.prototype.initLightningOut=function Z(aD){if(this.hasSessionDataLoaded){if(typeof Promise!=="function"){this.loadScriptFromDirectory("common","promisepolyfill",function(){this.initLightningOut(aD);}.bind(this),true);}else{this.loadLightningOutScripts().then(this.loadLightningApp.bind(this,aD));}}};B.prototype.setHelpButtonText=function m(aH,aJ){var aI=this.settings.showIcon===undefined?true:this.settings.showIcon;var aD=aJ===undefined?aI:aJ;var aG=document.getElementById("helpButtonSpan");var aE;var aF;if(aG){aE=aG.querySelector(".message");aE.innerHTML=aH;aF=aG.parentElement.querySelector(".embeddedServiceIcon");if(aF){aF.style.display=aD?"inline-block":"none";}}};B.prototype.prepareDOM=function aa(){if(this.domInitInProgress){return;}this.domInitInProgress=true;this.appendIFrame();};B.prototype.addSessionHandlers=function aC(){this.addMessageHandler("session.onLoad",function(){this.postMessage("session.get",this.storageKeys);}.bind(this));this.addMessageHandler("session.sessionData",function(aD){this.resumeInitWithSessionData(aD);}.bind(this));this.addMessageHandler("session.deletedSessionData",function(aD){if(aD.indexOf("CHASITOR_SERIALIZED_KEY")>-1){this.loginPendingSerializedData=undefined;}}.bind(this));this.addMessageHandler("session.updateMaster",function(aD){if(aD){if(aD.isMaster){sessionStorage.setItem(this.settings.storageDomain+"MASTER_DEPLOYMENT_ID",this.settings.deploymentId);}else{sessionStorage.removeItem(this.settings.storageDomain+"MASTER_DEPLOYMENT_ID");}this.isMasterAndHasSlaves=aD.activeChatSessions>1&&aD.isMaster;if(embedded_svc&&embedded_svc.liveAgentAPI){embedded_svc.liveAgentAPI.browserSessionInfo=aD;}}}.bind(this));};B.prototype.addMetaTag=function(aD,aF){var aE=document.createElement("meta");aE.name=aD;aE.content=aF;document.head.appendChild(aE);};B.prototype.init=function S(aF,aH,aE,aD,aI,aG){this.settings.baseCoreURL=aF;this.settings.communityEndpointURL=aH;this.settings.gslbBaseURL=aE?aE:aF;this.settings.orgId=aD;this.settings.releaseVersion=E;this.settings.eswConfigDevName=aI;this.mergeSettings(aG||{});this.adjustCommunityStorageDomain();if(typeof this.settings.baseCoreURL!=="string"){throw new Error("Base core URL value must be a string.");}if(!this.isOrganizationId(this.settings.orgId)){throw new Error("Invalid OrganizationId Parameter Value: "+this.settings.orgId);}if(this.fireEvent("validateInit",function(aJ){return aJ.indexOf(false)!==-1;},this.settings)){return;}this.checkForNativeFunctionOverrides();if(this.settings.appendHelpButton){this.loadCSS();}if(!this.settings.targetElement){throw new Error("No targetElement specified");}this.settings.iframeURL=this.settings.gslbBaseURL+"/embeddedservice/"+this.settings.releaseVersion+(this.settings.devMode?"/eswDev.html":"/esw.html")+"?parent="+document.location.href;this.addSessionHandlers();this.loadFeatures(this.onFeatureScriptsLoaded.bind(this));this.fireEvent("afterInit",undefined,this.settings);};B.prototype.onFeatureScriptsLoaded=function T(){if(document.readyState==="complete"){setTimeout(this.prepareDOM.bind(this),1);}else{if(document.addEventListener){document.addEventListener("DOMContentLoaded",this.prepareDOM.bind(this),false);window.addEventListener("load",this.prepareDOM.bind(this),false);}else{if(window.attachEvent){window.attachEvent("onload",this.prepareDOM.bind(this));}else{this.log("No available event model. Exiting.");}}}};B.prototype.checkForNativeFunctionOverrides=function ai(){var aE=["addEventListener","createAttribute","createComment","createDocumentFragment","createElementNS","createTextNode","createRange","getElementById","getElementsByTagName","getElementsByClassName","querySelector","querySelectorAll","removeEventListener"];var aF=["addEventListener","clearTimeout","dispatchEvent","open","removeEventListener","requestAnimationFrame","setInterval","setTimeout"];var aD=[{name:"Document",object:document,functions:aE},{name:"Window",object:window,functions:aF}];aD.forEach(function(aG){aG.functions.forEach(function(aH){if(aH in aG.object&&!this.isNativeFunction(aG.object,aH)){this.warning("Embedded Service Chat may not function correctly with this native "+aG.name+" JS function modified: "+aH);}}.bind(this));}.bind(this));};B.prototype.isNativeFunction=function av(aD,aE){return Function.prototype.toString.call(aD[aE]).match(/\[native code\]/);};B.prototype.onHelpButtonClick=function ah(){if(!this.componentInitInProgress&&!document.getElementsByClassName("embeddedServiceSidebar").length){this.componentInitInProgress=true;try{this.checkAuthentication();embedded_svc.fireEvent("onHelpButtonClick");}catch(aD){this.componentInitInProgress=false;throw aD;}}};B.prototype.resumeInitWithSessionData=function V(aF){var aE=this.fireEvent("sessionDataRetrieved",function(aH){return aH.indexOf(true)!==-1;},aF);var aD=false;var aG=false;if(this.settings.linkAction.valid){aD=true;}else{if(aE){this.log("Existing session found. Continuing with data: "+aF);aD=true;aG=true;if(embedded_svc.menu){embedded_svc.menu.hideFabAndChannelMenu();}}else{if(this.componentInitInProgress){aD=true;}}}this.hasSessionDataLoaded=true;if(aF[R]){this.auth.oauthToken=aF[R];}this.loginPendingSerializedData=aG?aF:undefined;if(aD){this.componentInitInProgress=true;this.checkAuthentication();}if(this.settings.appendHelpButton){this.appendHelpButton(this.settings.displayHelpButton&&!aE);}};B.prototype.checkAuthentication=function h(){if(this.isAuthenticationRequired&&!this.settings.allowGuestUsers){if(this.auth.oauthToken){if(this.loginButtonPressed||this.componentInitInProgress){this.initLightningOut(this.loginPendingSerializedData);}}else{this.fireEvent("requireauth");}}else{if(this.loginButtonPressed||this.componentInitInProgress){this.initLightningOut(this.loginPendingSerializedData);}}};B.prototype.postMessage=function d(aG,aE){var aD={domain:this.settings.storageDomain,data:aE,method:aG};var aF=this.getESWFrame();if(aF){aF.postMessage(aD,this.settings.iframeURL);}else{this.outboundMessagesAwaitingIframeLoad.push(aD);}};B.prototype.setSessionData=function o(aF,aD){var aE;if(typeof aF==="object"){aE=aF;}else{aE={};aE[aF]=aD;}this.postMessage("session.set",aE);};B.prototype.deleteSessionData=function aw(aD){var aE;if(Array.isArray(aD)){aE=aD;}else{aE=[aD];}this.postMessage("session.delete",aE);};B.prototype.defineFeature=function D(aD,aE){this.featureScripts[aD]=aE;};B.prototype.registerStorageKeys=function y(aD){if(typeof aD==="string"){this.storageKeys.push(aD);}else{aD.forEach(function(aE){this.storageKeys.push(aE);}.bind(this));}};B.prototype.addMessageHandler=function au(aD,aE){this.messageHandlers[aD]=aE;};B.prototype.loadStorageScript=function G(aD){if(this.isIframeReady){this.postMessage("script.load",aD);}else{this.iframeScriptsToLoad.push(aD);}};B.prototype.loadScriptFromDirectory=function W(aD,aF,aI,aJ){var aG=aF.toLowerCase();var aE=document.createElement("script");var aH=this.settings.gslbBaseURL;aE.type="text/javascript";aE.src=[aH,"embeddedservice",aJ?undefined:this.settings.releaseVersion,aD,aG+(this.settings.devMode?"":".min")+".js"].filter(function(aK){return Boolean(aK);}).join("/");if(aI){aE.onload=aI;}document.body.appendChild(aE);};B.prototype.loadFeatures=function v(aD){this.settings.enabledFeatures.forEach(function(aE){if(aE!=="base"&&this.availableFeatures.indexOf(aE.toLowerCase())===-1){this.loadFeatureScript(aE,aD);}}.bind(this));};B.prototype.addEventHandler=function s(aE,aD){var aF=aE.toLowerCase();if(!this.eventHandlers[aF]){this.eventHandlers[aF]=[];}this.eventHandlers[aF].push(aD);};B.prototype.setupMessageListener=function u(){window.addEventListener("message",function(aG){var aI=aG.data;var aD=aG.origin.split(":")[1].replace("//","");var aF;var aH;var aE;if(aI&&aI.method&&embedded_svc.isMessageFromSalesforceDomain(aD)){if(aI.method==="session.onLoad"&&this.settings.iframeURL.indexOf(aD)===-1){aH=this.settings.iframeURL.split("/")[2];aE=aG.origin.split("/")[2];this.settings.iframeURL=this.settings.iframeURL.replace(aH,aE);}aF=aI.method.split(".")[0].toLowerCase();if(this.availableFeatures.indexOf(aF)===-1){if(!this.pendingMessages[aF]){this.pendingMessages[aF]=[];}this.pendingMessages[aF].push({direction:"incoming",payload:aI});}else{this.handleMessage(aI);}}}.bind(this),false);};B.prototype.handleMessage=function H(aD){if(this.messageHandlers[aD.method]){this.messageHandlers[aD.method](aD.data);}else{this.log("Unregistered method "+aD.method+" received.");}};B.prototype.isMessageFromSalesforceDomain=function C(aF){var aD=window.$A&&typeof window.$A.get==="function"&&window.$A.get("$Site");var aE;if(aD&&aF===document.domain){return true;}aE=function(aH,aG){return aH.indexOf(aG,aH.length-aG.length)!==-1;};return aq.some(function(aG){return aE(aF,aG);});};B.prototype.isCommunityDomain=function k(aD){return aD.substr(-".force.com".length)===".force.com";};B.prototype.isSamePageNavigation=function ae(){var aD;var aE=document.domain;if(this.isCommunityDomain(document.domain)){aE=aE+"/"+window.location.pathname.split("/")[1];}aD=aE.substr(-this.settings.storageDomain.length)===this.settings.storageDomain;return aD;};B.prototype.addDefaultSetting=function an(aE,aD){this.defaultSettings[aE]=aD;};B.prototype.onButtonStatusChange=function q(){var aD=document.querySelector(".embeddedServiceHelpButton button");var aE;if(embedded_svc.menu){embedded_svc.menu.onAgentAvailabilityChange();}if(aD){aE=aD.querySelector(".message");if(aE){if(this.isButtonDisabled){aD.onclick=function(){};aD.classList.remove("helpButtonEnabled");aD.classList.add("helpButtonDisabled");aE.innerHTML=this.settings.disabledMinimizedText;}else{aD.onclick=this.onHelpButtonClick.bind(this);aD.classList.remove("helpButtonDisabled");aD.classList.add("helpButtonEnabled");aE.innerHTML=this.settings.defaultMinimizedText;}}}};B.prototype.hideHelpButton=function ad(){var aD=document.querySelector("."+O);if(aD){aD.style.display="none";}};B.prototype.showHelpButton=function b(){var aD=document.querySelector("."+O);if(aD){aD.style.display="";}};B.prototype.setDefaultButtonText=function aj(aG,aF,aE,aD){if(this.settings.entryFeature===aG){this.settings.defaultMinimizedText=this.settings.defaultMinimizedText||aF;this.settings.disabledMinimizedText=this.settings.disabledMinimizedText||aE;this.settings.defaultAssistiveText=this.settings.defaultAssistiveText||aD||"";}};B.prototype.setDefaultShowIcon=function ab(aE,aD){if(this.settings.entryFeature===aE&&this.settings.showIcon===undefined){this.settings.showIcon=aD;}};B.prototype.registerLinkAction=function x(aE,aD){var aF=this.settings.linkAction;if(!this.validLinkActions[aE]){this.validLinkActions[aE]=[];}if(this.validLinkActions[aE].indexOf(aD)===-1){this.validLinkActions[aE].push(aD);}if(aF.feature&&aF.name&&aF.feature.toLowerCase()===aE.toLowerCase()&&aF.name.toLowerCase()===aD.toLowerCase()){aF.valid=true;aF.feature=aE;this.settings.entryFeature=aE;}};B.prototype.setLinkAction=function ak(aE,aG,aF){var aD=Object.keys(this.validLinkActions).filter(function(aH){return aH.toLowerCase()===aE.toLowerCase();})[0];if(aD){this.settings.linkAction.feature=aD;this.settings.linkAction.name=this.validLinkActions[aD].filter(function(aH){return aH.toLowerCase()===aG.toLowerCase();})[0];this.settings.linkAction.valid=this.settings.linkAction.name!==undefined;this.settings.linkActionParameters=aF;}else{this.settings.linkAction.valid=false;}};B.prototype.getLinkActionData=function g(){window.location.search.replace(/([a-zA-Z0-9._]+)=([^&\s]+)/g,function(aE,aF,aH){var aG=aF.toLowerCase();var aI;var aD;if(aG.indexOf("snapins.")===0){aD=aG.replace("snapins.","");if(aD==="action"){aI=aH.split(".");if(aI.length===2){this.settings.linkAction.feature=aI[0];this.settings.linkAction.name=aI[1];}}else{this.settings.linkActionParameters[aD.toLowerCase()]=aH;}}}.bind(this));};B.prototype.requireAuthentication=function at(){var aD=document.createElement("script");var aF=document.createElement("style");var aE=document.querySelector(this.settings.loginTargetQuerySelector);this.isAuthenticationRequired=true;if(window.location.protocol!=="https:"&&!this.settings.devMode){this.settings.displayHelpButton=false;throw new Error("Snap-in authentication requires HTTPS.");}if(!this.settings.useCustomAuthentication){if(!this.settings.loginClientId||!this.settings.loginRedirectURL||!this.settings.loginTargetQuerySelector){throw new Error("Authentication in Snap-ins requires these valid settings params: loginClientId, loginRedirectURL, loginTargetQuerySelector.");}if(aE){this.loginButtonPressed=false;aE.addEventListener("click",function(){this.loginButtonPressed=true;}.bind(this));}else{throw new Error("loginTargetQuerySelector is not a valid DOM element.");}this.addMetaTag("salesforce-community",this.settings.communityEndpointURL);this.addMetaTag("salesforce-client-id",this.settings.loginClientId);this.addMetaTag("salesforce-redirect-uri",this.settings.loginRedirectURL);this.addMetaTag("salesforce-mode","popup");this.addMetaTag("salesforce-target",this.settings.loginTargetQuerySelector);this.addMetaTag("salesforce-login-handler",L);this.addMetaTag("salesforce-logout-handler",t);this.addEventHandler("requireauth",function(){var aG=setInterval(function(){if(window.SFIDWidget){clearInterval(aG);if(window.SFIDWidget.openid_response){window[L]();}else{window.SFIDWidget.login();}}},az);});this.addEventHandler("autherror",function(aH){var aG;if(window.SFIDWidget){this.loginButtonPressed=true;window.SFIDWidget.logout();aG=setInterval(function(){if(window.SFIDWidget.config){clearInterval(aG);this.fireEvent("requireauth");}}.bind(this,aG),az);}}.bind(this));window[L]=function(){var aH=document.querySelector(this.settings.loginTargetQuerySelector);var aG=document.createElement("button");if(this.loginButtonPressed||this.componentInitInProgress){aH.innerHTML="";}aG.className="authenticationStart";aG.innerHTML=this.settings.authenticationStartLabel;aG.addEventListener("click",this.onHelpButtonClick.bind(this));aH.appendChild(aG);this.auth.oauthToken=window.SFIDWidget.openid_response.access_token;}.bind(this);window[t]=function(){this.auth.oauthToken=undefined;window.SFIDWidget.init();}.bind(this);document.head.appendChild(aF);aF.sheet.insertRule(".sfid-logout { display: none; }",0);aD.type="text/javascript";aD.src=this.settings.communityEndpointURL+"/servlet/servlet.loginwidgetcontroller?type=javascript_widget"+(embedded_svc.settings.devMode?"&min=false":"");document.head.appendChild(aD);}};B.prototype.requireSLDS=function z(){var aE;var aD;var aF;this.settings.requireSLDS=true;if(this.settings.targetElement===document.body){aE=document.createElement("div");aE.id=ac;document.body.appendChild(aE);this.settings.targetElement=aE;}this.settings.targetElement.classList.add(l);aD=document.createElement("link");aF=this.settings.gslbBaseURL?this.settings.gslbBaseURL:this.settings.baseCoreURL;aD.href=aF+"/embeddedservice/"+this.settings.releaseVersion+"/esw-slds"+(this.settings.devMode?"":".min")+".css";aD.type="text/css";aD.rel="stylesheet";document.getElementsByTagName("head")[0].appendChild(aD);};B.prototype.validateHeaderValue=function n(aD){return/^[0-9a-zA-Z!#$%&'*+-.^_`|~" ]*$/g.test(aD);};B.prototype.isLanguageRtl=function K(aD){if(!aD||aD.trim()===""){return undefined;}switch(aD.substring(0,2)){case"ar":case"fa":case"he":case"iw":case"ji":case"ur":case"yi":return true;default:return false;}};B.prototype.isDesktop=function I(){return navigator.userAgent.indexOf("Mobi")===-1;};window.embedded_svc=new B();Object.getOwnPropertyNames(U).forEach(function(aD){var aE=U[aD];if(aE==="object"){window.embedded_svc[aD]={};Object.keys(aE).forEach(function(aF){window.embedded_svc[aD][aF]=aE[aF];});}else{window.embedded_svc[aD]=aE;}});})(window.embedded_svc||{});